Task 2: Average Purchase Value and Most Recent Purchase by Customer (E-commerce Industry)
Problem Statement
You work for an e-commerce fashion retailer, and the company wants to analyze customer behavior in more detail. Specifically, they want to:

- Calculate the average purchase value for each customer.
- Identify the most recent purchase date for each customer.

purchases table:

purchase_id | customer_id | purchase_date | purchase_amount
------------|-------------|---------------|----------------
101         | 1           | 2023-01-10    | 100.00
102         | 2           | 2023-02-20    | 150.00
103         | 3           | 2023-03-15    | 50.00
104         | 1           | 2023-04-05    | 200.00
105         | 5           | 2023-06-25    | 75.00

Question
For each customer, calculate:

- The average purchase value (total amount spent divided by total purchases).
- The most recent purchase date for each customer.
- Display the results ordered by average purchase value in descending order.

Solution:
SEELECT
    customer_id,
    AVG(purchase_amount) as AVG_purchs,
    MAX(purchase_date) as recent_purchase
FROM purchases
GROUP BY customer_id
ORDER BY AVG_purchs DESC
